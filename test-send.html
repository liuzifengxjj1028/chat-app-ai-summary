<!DOCTYPE html>
<html>
<head><title>æµ‹è¯•å‘é€æ¶ˆæ¯</title></head>
<body>
<h1>æµ‹è¯•å‘é€æ¶ˆæ¯</h1>
<div id="log"></div>
<script>
const log = (msg) => {
    document.getElementById('log').innerHTML += '<p>' + msg + '</p>';
    console.log(msg);
};

const ws = new WebSocket('ws://localhost:8080/ws');

ws.onopen = () => {
    log('âœ… è¿æ¥æˆåŠŸ');
    
    // æ³¨å†Œç”¨æˆ·
    const register = {type: 'register', username: 'test123'};
    ws.send(JSON.stringify(register));
    log('å‘é€æ³¨å†Œ: ' + JSON.stringify(register));
    
    // 2ç§’åå‘é€æ¶ˆæ¯
    setTimeout(() => {
        const msg = {type: 'send_message', to: 'budd', content: 'Hello from test', content_type: 'text', timestamp: new Date().toISOString()};
        ws.send(JSON.stringify(msg));
        log('ğŸ“¤ å‘é€æ¶ˆæ¯: ' + JSON.stringify(msg));
    }, 2000);
};

ws.onmessage = (e) => {
    log('ğŸ“© æ”¶åˆ°: ' + e.data);
};

ws.onerror = (e) => {
    log('âŒ é”™è¯¯: ' + e);
};
</script>
</body>
</html>
